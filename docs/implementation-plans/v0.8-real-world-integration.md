# Version 0.8: Real-World Integration Continued - Implementation Plan

**Status:** ðŸš§ **IN PROGRESS**

**Goal:** Continue real-world integration features (Remote Connection, Critical Gaps, API Polish) building on v0.7 foundation.

**Releases:**
- v0.8.0: Typed Evaluate API (2025-12-30) - Community contribution by @douglasob
- v0.8.1: Persistent Contexts & App Mode (2026-01-04) - Addressed Issue #9 (App Mode)
- v0.8.x: Remote Connection & API Polish (Planned)

**Related:**
- [Roadmap](../roadmap.md)
- [ADR 0004: Typed Evaluate API](../adr/0004-generic-evaluate.md)
- [v0.7 Implementation Plan](v0.7-single-crate.md)

---

## Version Bump Rationale

**Why v0.8.0 instead of v0.7.3?**

Community contribution PR #8 (@douglasob) introduced a **major new feature** - typed `evaluate()` with argument serialization - that warranted a minor version bump per semantic versioning:

- âœ… New public API: `Page::evaluate<T, U>()`
- âœ… Closes critical capability gap (argument passing to JavaScript)
- âœ… Significant user-facing feature addition

This contribution was substantial enough to merit closing v0.7 and starting v0.8. The remaining v0.7 items (Remote Connection, Critical Gaps, API Polish) continue as planned in v0.8.

---

## Vertical Slices

### Slice 0: Typed Evaluate API (v0.8.0)

**Status:** âœ… **COMPLETE** (2025-12-30)

**Goal:** Implement typed `evaluate()` method with argument serialization and typed results.

**Key Deliverables:**
- [x] Generic `Page::evaluate<T: Serialize, U: DeserializeOwned>()`
- [x] Serialization module for Playwright protocol format
- [x] Example: `evaluate_typed.rs`

**Community Credit:**
- Implementation by @douglasob (Douglas Braga)
- See [ADR 0004](../adr/0004-generic-evaluate.md) for complete details

---

### Slice 0.1: Persistent Contexts & App Mode (v0.8.1)

**Status:** âœ… **COMPLETE** (2026-01-04)

**Goal:** Implement `launchPersistentContext` to support app mode and session persistence (Issue #9).

**Key Deliverables:**
- [x] `BrowserType::launch_persistent_context` & `launch_persistent_context_with_options`
- [x] Support for `--app=url` (standalone window)
- [x] Persistent user data directory support
- [x] App mode initial page handling
- [x] Example: `persistent_context.rs`

---

### Slice 1: Remote Connection (released as v0.8.2)

**Status:** âœ… **COMPLETE** (2026-01-17)

**Goal:** Implement `BrowserType::connect` for remote browser connection (critical for CI/CD).

**User Story:** As a developer, I want to connect to a remote Playwright browser (e.g., in Docker or BrowserStack) so I can run tests in CI/CD environments.

**Key Deliverables:**
- [x] `ConnectOptions` struct with headers, slow_mo, timeout builder pattern
- [x] `BrowserType::connect(ws_endpoint, options)` method
- [x] WebSocket transport (`tokio-tungstenite`) with transport abstraction
- [x] Connection timeout support (default 30s)

**Implementation Notes:**
- Added `TransportSender` and `TransportReceiver` traits for transport abstraction
- Refactored `PipeTransport` to use new trait-based architecture
- Fixed object factory to allow BrowserType as root child (protocol compliance)
- `connect_over_cdp` deferred to future slice (optional feature)

---

### Slice 2: Critical Feature Gaps (released as v0.8.2)

**Status:** âœ… **COMPLETE** (2026-01-19)

**Goal:** Address critical missing features and stability issues identified in the gap analysis.

**Tasks:**
- [x] **[CRITICAL]** Audit `Locator` API (specifically `select_option`, `set_input_files`)
- [x] Implement `WebSocket` event handling (`on_websocket`)

---

### Slice 3: API Polish & DX (released as v0.8.2)

**Status:** âœ… **COMPLETE** (2026-01-19)

**Goal:** Improve developer experience and API completeness before v1.0.

**Tasks:**
- [x] **File Payload Improvements**: Add `FilePayload::from_path()` and `from_file()` with automatic MIME type guessing (crate `mime_guess`)
- [x] **BrowserContext Options**: Add missing options:
  - HAR recording (`record_har_path`, `record_har_url_filter`, etc.)
  - Video recording (`record_video_dir`, `record_video_size`)
  - `service_workers`, `strict_selectors`, `reduced_motion`, `forced_colors`
- [x] **Route API Review**: Verify `route.continue_()` overrides and `route.fulfill()` behavior (known limitation: body not sent)
- [x] **Error Handling**: Add `Error::context()` to provide better failure location details (e.g. "Failed to click element")

---

**Last Updated:** 2026-01-19
